[%# 1.0@bugzilla.org %]
[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # Contributor(s): Gavin Shelley <bugzilla@chimpychompy.org>
  #%]

[%# INTERFACE:
  # product_name: string; The name of the product
  #
  # prod_description: string; Product description, may be empty
  #
  # (classification fields available if Param('useclassification') is enabled:)
  #
  # classification: string; The name of the classification the product is in
  #
  # class_description: string; Classification description, may be empty
  #
  # bug_count: number; The number of bugs belonging to the product
  #
  # milestoneurl: string; milestone url, if milestones are in use,
  #                       may be empty
  #
  # disallownew: boolean; Are new bugs allowed for the product flag
  #
  # components: list of hashes, members are: name, description
  #
  # versions: list of version values.
  #
  # milestones: list of milestone values.
  #
  #%]

[% title = BLOCK %]Usuwanie produktu '[% product_name FILTER html %]'
[% END %]

[% PROCESS global/header.html.tmpl
  title = title
  style_urls = ['skins/standard/admin.css']
%]

[% IF classification %]
  [% classification_url_part = BLOCK %]&amp;classification=
    [%- classification FILTER url_quote %]
  [%- END %]
[% ELSE %]
  [% classification_url_part = "" %]
[% END %]

[% UNLESS class_description %]
  [% class_description = '<span style="color: red">brak</span>' %]
[% END %]
[% UNLESS prod_description %]
  [% prod_description = '<span style="color: red">brak</span>' %]
[% END %]

[% IF disallownew %]
  [% disallownew = "tak" %]
[% ELSE %]
  [% disallownew = "nie" %]
[% END %]

<table border="1" cellpadding="4" cellspacing="0">
  <tr bgcolor="#6666FF">
    <th valign="top" align="left">Pole</th>
    <th valign="top" align="left">Wartość</th>
  </tr>

  [% IF Param('useclassification') %]
    <tr>
      <td>Klasyfikacja:</td>
      <td>[% classification FILTER html %]</td>
    </tr>
    <tr>
      <td>Opis klasyfikacji:</td>
      [%# descriptions are intentionally not filtered to allow html content %]
      <td>[% class_description FILTER none %]</td>
    </tr>
  [% END %]

  <tr>
    <td valign="top">Produkt:</td>
    <td valign="top">
      <a href="editproducts.cgi?product=[% product_name FILTER url_quote %]
         [%- classification_url_part %]">
        [% product_name FILTER html %]
      </a>
    </td>
  </tr>
  <tr>
    <td valign="top">Opis:</td>
    [%# descriptions are intentionally not filtered to allow html content %]
    <td valign="top">[% prod_description FILTER none %]</td>
  </tr>

  [% IF Param('usetargetmilestone') %]
    <tr>
      <td>URL do wersji docelowych produktu:</td>
      <td>
        [% IF milestoneurl %]
          <a href="[% milestoneurl FILTER uri %]">
            [%- milestoneurl FILTER html %]
          </a>
        [% ELSE %]
          brak
        [% END %]
      </td>
    </tr>
  [% END %]

  <tr>
    <td>Zamknięty dla [% terms.bledow %]:</td>
    <td>[% disallownew FILTER html %]</td>
  </tr>

  <tr>
    <td>
      [% IF components.size > 0 %]
        <a href="editcomponents.cgi?product=[% product_name FILTER url_quote %]
           [%- classification_url_part %]"
           title="Edytuj komponenty produktu '[% product_name FILTER html %]'">
          Komponenty:
        </a>
      [% ELSE %]
        Komponenty:
      [% END %]
    </td>
    <td>
      [% IF components.size > 0 %]
        <table>
          [% FOREACH c = components %]
            <tr>
              <th align="right">[% c.name FILTER html %]:</th>
              [%# descriptions are intentionally not filtered to allow html content %]
              <td>
                [% IF c.description %]
                  [% c.description FILTER none %]
                [% ELSE %]
                  <span style="color: red">brak</span>
                [% END %]
              </td>
            </tr>
          [% END %]
        </table>
      [% ELSE %]
        brak
      [% END %]
    </td>
  </tr>

  <tr>
    <td>
      [% IF versions.size > 0 %]
        <a href="editversions.cgi?product=[%- product_name FILTER url_quote %]
           [%- classification_url_part %]">
          Wersje:
        </a>
      [% ELSE %]
        Wersje:
      [% END %]
    <td>
      [% IF versions.size > 0 %]
        [% FOREACH v = versions %]
          [% v FILTER html %]<br>
        [% END %]
      [% ELSE %]
        brak
      [% END %]
    </td>
  </tr>

  <tr>
    <td valign="top">
      [% IF milestones.size > 0 %]
        <a href="editmilestones.cgi?product=[%- product_name FILTER url_quote %]
           [%- classification_url_part -%]">
          Wersje docelowe:
        </a>
      [% ELSE %]
        Wersje docelowe:
      [% END %]
    </td>
    <td>
      [% IF milestones.size > 0 %]
        [% FOREACH m = milestones %]
          [% m FILTER html %]<br>
        [% END %]
      [% ELSE %]
        brak
      [% END %]
    </td>
  </tr>

  <tr>
    <td>[% terms.Bledy %]:</td>
    <td>
      [% IF bug_count %]
        <a href="buglist.cgi?product=[%- product_name FILTER url_quote %]
           [%- classification_url_part %]"
           title="List of [% terms.bugs %] for product '
           [%- product_name FILTER html %]'">
          [% bug_count %]
        </a>
      [% ELSE %]
        brak
      [% END %]
    </td>
  </tr>
</table>

<h2>Potwierdzenie</h2>

[% IF bug_count %]

  [% IF !Param("allowbugdeletion") %]

    Niestety ten produkt nadal ma [% bug_count %] 
    
    [% PROCESS ODMIEN c=bug_count o1="przypisany $terms.blad"
        o2="przypisane $terms.bledy" o3="przypisanych $terms.bledow" %]

    Zanim możliwe będzie skasowanie tego produktu musisz przepisać 

    [% IF bug_count > 1 %]
       te [% terms.bledy %]
    [% ELSE %]
       ten [% terms.blad %]
    [% END %]

    do innego peoduktu.

  [% ELSE %]

    <table border="0" cellpadding="20" width="70%" bgcolor="red">
      <tr>
        <td>
          Ten produkt ma [% bug_count %] 
        
          [% PROCESS ODMIEN c=bug_count o1="przypisany $terms.blad!"
                o2="przypisane $terms.bledy!" o3="przypisanych $terms.bledow!" %]
        
          Jeśli skasujesz ten produkt, <b><blink>WSZYSTKIE</blink></b> 
          [% terms.bledy %] oraz cała ich historia również zostanie usunięta.
        </td>
      </tr>
    </table>

  [% END %]

[% END %]

[% IF bug_count == 0 || Param('allowbugdeletion') %]

  <p>Czy jesteś pewien że chcesz usunąć ten produkt?<p>

  <form method="post" action="editproducts.cgi">
    <input type="submit" value="Tak, usuń">
    <input type="hidden" name="action" value="delete">
    <input type="hidden" name="product" value="[% product_name FILTER html %]">
    <input type="hidden" name="classification"
           value="[% classification FILTER html %]">
  </form>

[% END %]

[% PROCESS admin/products/footer.html.tmpl %]

[% PROCESS global/footer.html.tmpl %]
